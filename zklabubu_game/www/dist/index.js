(()=>{var e,o,n={},t={};function l(e){var o=t[e];if(void 0!==o)return o.exports;var r=t[e]={exports:{}};return n[e](r,r.exports,l),r.exports}l.m=n,l.d=(e,o)=>{for(var n in o)l.o(o,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((o,n)=>(l.f[n](e,o),o)),[])),l.u=e=>e+".index.js",l.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),e={},o="zklabubuio-game-sp1:",l.l=(n,t,r,s)=>{if(e[n])e[n].push(t);else{var a,c;if(void 0!==r)for(var d=document.getElementsByTagName("script"),i=0;i<d.length;i++){var u=d[i];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==o+r){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,l.nc&&a.setAttribute("nonce",l.nc),a.setAttribute("data-webpack",o+r),a.src=n),e[n]=[t];var g=(o,t)=>{a.onerror=a.onload=null,clearTimeout(m);var l=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),l&&l.forEach((e=>e(t))),o)return o(t)},m=setTimeout(g.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=g.bind(null,a.onerror),a.onload=g.bind(null,a.onload),c&&document.head.appendChild(a)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="/",(()=>{l.b=document.baseURI||self.location.href;var e={792:0};l.f.j=(o,n)=>{var t=l.o(e,o)?e[o]:void 0;if(0!==t)if(t)n.push(t[2]);else{var r=new Promise(((n,l)=>t=e[o]=[n,l]));n.push(t[2]=r);var s=l.p+l.u(o),a=new Error;l.l(s,(n=>{if(l.o(e,o)&&(0!==(t=e[o])&&(e[o]=void 0),t)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+o+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,t[1](a)}}),"chunk-"+o,o)}};var o=(o,n)=>{var t,r,[s,a,c]=n,d=0;if(s.some((o=>0!==e[o]))){for(t in a)l.o(a,t)&&(l.m[t]=a[t]);c&&c(l)}for(o&&o(n);d<s.length;d++)r=s[d],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkzklabubuio_game_sp1=self.webpackChunkzklabubuio_game_sp1||[];n.forEach(o.bind(null,0)),n.push=o.bind(null,n.push.bind(n))})();let r,s=!1,a=null,c=0,d=!0,i=!1,u=null;const g=document.getElementById("main-menu"),m=document.getElementById("how-to-play"),p=document.getElementById("game-screen"),y=document.getElementById("game-over"),b=document.getElementById("initial-loading-screen"),f=document.getElementById("game-canvas"),w=(f.getContext("2d"),document.getElementById("score")),h=document.getElementById("lives"),_=document.getElementById("game-stars"),E=document.getElementById("final-score"),v=document.getElementById("final-stats"),k=document.getElementById("global-sound-btn"),I=document.getElementById("pause-game-btn"),x=document.getElementById("pause-menu"),P=document.getElementById("resume-game-btn"),C=document.getElementById("restart-pause-btn"),S=document.getElementById("home-pause-btn"),B=document.getElementById("how-to-play-btn"),L=document.getElementById("back-to-menu-btn"),A=document.getElementById("home-btn"),$=document.getElementById("share-btn"),T=document.getElementById("play-again-btn"),z=document.getElementById("prove-btn");let M=new Image,G=new Image,q=new Image,F=new Image,O=new Image,W=new Image,R=new Image,j=new Image,D=new Image,H=new Image,N=new Image,U=new Image,Y=new Image,K=new Image,Z=new Image,J=new Image,Q=new Image,V=new Image,X=new Audio,ee=new Audio,oe=new Audio,ne=new Audio,te=new Audio;function le(e){const o=document.getElementById("loading-progress");o&&(o.style.width=`${e}%`)}function re(e){e?(x.classList.remove("hidden"),a&&a.stop()):(x.classList.add("hidden"),a&&a.start())}function se(){const e=document.querySelector(".container"),o=document.querySelector(".game-info").offsetHeight,n=e.offsetHeight-o-20;f.width=e.offsetWidth-40,f.height=n,Q&&Q.complete&&(document.getElementById("game-screen").style.backgroundImage=`url(${Q.src})`)}function ae(e){if(console.log(`Showing screen: ${e.id}`),e)try{if(document.querySelectorAll(".screen").forEach((e=>{e.classList.remove("active"),e.style.display="none"})),e.classList.add("active"),e.style.display="flex",te&&te.readyState>=2&&d)try{te.currentTime=0,te.play().catch((e=>console.log("Could not play sound:",e)))}catch(e){console.warn("Error playing sound:",e)}"main-menu"===e.id||"how-to-play"===e.id?J&&J.complete&&(e.style.backgroundImage=`url(${J.src})`):"game-screen"===e.id?Q&&Q.complete&&(e.style.backgroundImage=`url(${Q.src})`):"game-over"===e.id&&(V&&V.complete&&(e.style.backgroundImage=`url(${V.src})`),e.style.zIndex=100)}catch(e){console.error("Error showing screen:",e)}else console.error("Invalid screen parameter!")}function ce(){d=!d;const e=document.getElementById("global-sound-btn");e?d?(e.textContent="üîä",X.play().catch((e=>{console.log("Could not play background music:",e)})),console.log("Sounds enabled")):(e.textContent="üîá",X.pause(),console.log("Sounds disabled")):console.warn("Global sound button not found in DOM"),d&&te&&(te.currentTime=0,te.play().catch((e=>{console.log("Could not play button sound:",e)}))),a&&"function"==typeof a.set_sound_enabled&&a.set_sound_enabled(d)}function de(){if(!s||!window.wasm)return console.error("WASM module not loaded yet!"),void alert("Game module not loaded yet, please wait a moment and try again.");if(!u)return console.error("No team selected!"),void alert("Please select a team first.");re(!1),ae(p),se(),r&&(cancelAnimationFrame(r),r=null),c=0;try{a?a.restart():(console.log("Creating GameManager with team:",u),console.log("Available WASM exports:",Object.keys(window.wasm)),a=new window.wasm.GameManager(f,M,F,W,j,D,H,N,U,Y,K,Z,ee,oe,ne)),a.start(),d&&(X.currentTime=0,X.play().catch((e=>{console.log("Could not play background music:",e)}))),r=requestAnimationFrame(ge)}catch(e){console.error("Error starting game:",e),console.error("Error details:",e.stack),alert("An error occurred while starting the game: "+e.message)}}function ie(e){if(console.log("Team selected:",e),u=e,a){try{a.stop()}catch(e){console.warn("Error stopping game manager:",e)}a=null}r&&(cancelAnimationFrame(r),r=null),"blue"===e?(M=G,F=new Image,W=new Image,F.src=document.getElementById("labubu-blue-shield-img").src,W.src=document.getElementById("labubu-blue-double-img").src,console.log("Blue team images set successfully")):"pink"===e&&(M=q,F=new Image,W=new Image,F.src=document.getElementById("labubu-pink-shield-img").src,W.src=document.getElementById("labubu-pink-double-img").src,console.log("Pink team images set successfully"));const o="blue"===e?"Blue zkLabubu":"Pink zkLabubu";console.log(`${o} selected! Starting game...`),de()}function ue(){if(r&&(cancelAnimationFrame(r),r=null),X.pause(),a)try{a.stop()}catch(e){console.warn("Error stopping game manager:",e)}}function ge(e){c||(c=e);const o=(e-c)/1e3;if(c=e,x.classList.contains("hidden")){if(a)try{const e=a.update(o),n=a.get_score(),t=a.get_lives();let l=n;try{"function"==typeof a.get_visual_score&&(l=a.get_visual_score())}catch(e){console.warn("Could not get visual score:",e)}const s=a.get_yellow_eggs_count(),c=a.get_blue_eggs_count(),i=a.get_purple_eggs_count();if(w.textContent=`Score: ${l}`,h.textContent=`Lives: ${t}`,_.textContent=`Eggs: üü°${s} üîµ${c} üü£${i}`,e||a.is_game_over()||3===a.get_game_state())return console.log("Game over detected!"),void function(){if(console.log("Game ended"),r&&(cancelAnimationFrame(r),r=null),X&&(X.pause(),X.currentTime=0),d&&oe)try{oe.currentTime=0,oe.play().catch((e=>console.warn("Could not play sound:",e)))}catch(e){console.warn("Error playing sound:",e)}if(a)try{const e=a.get_score(),o=a.get_yellow_eggs_count(),n=a.get_blue_eggs_count(),t=a.get_purple_eggs_count();try{a.stop()}catch(e){console.warn("Error stopping game manager:",e)}document.querySelectorAll(".screen").forEach((e=>{e.style.display="none"})),E.textContent=`Your Score: ${e}`,v.textContent=`Eggs Collected: üü°${o} üîµ${n} üü£${t}`,y.style.backgroundImage=`url(${V.src})`,y.style.display="flex",y.style.zIndex="100"}catch(e){console.error("Error ending game:",e),alert("An error occurred while ending the game: "+e.message)}}()}catch(e){return console.error("Error in game loop:",e),ue(),void alert("An error occurred during the game: "+e.message)}r=requestAnimationFrame(ge)}else r=requestAnimationFrame(ge)}function me(){if(r&&(cancelAnimationFrame(r),r=null),X&&(X.pause(),X.currentTime=0),u=null,window.hideProofPanel(),a)try{a.stop()}catch(e){console.warn("Error stopping game manager:",e)}console.log("Returning to main menu..."),ae(g)}function pe(){if(ue(),document.querySelectorAll(".screen").forEach((e=>{e.style.display="none"})),u)try{de()}catch(e){console.error("Error restarting game:",e),alert("An error occurred while restarting the game: "+e.message)}else me()}window.createProofPanel=function(){console.log("Creating proof panel...");const e=document.getElementById("proof-panel");e&&e.remove();const o=document.createElement("div");o.id="proof-panel",o.style.position="fixed",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",o.style.width="85%",o.style.maxWidth="900px",o.style.height="500px",o.style.backgroundColor="rgba(12, 36, 97, 0.95)",o.style.color="#ffffff",o.style.padding="25px",o.style.borderRadius="15px",o.style.boxShadow="0 0 30px rgba(254, 34, 190, 0.3)",o.style.border="2px solid #fe22be",o.style.zIndex="1000",o.style.display="flex",o.style.flexDirection="column";const n=document.createElement("div");n.style.display="flex",n.style.justifyContent="space-between",n.style.alignItems="center",n.style.paddingBottom="15px",n.style.borderBottom="2px solid #fe22be",n.style.marginBottom="15px";const t=document.createElement("div");t.textContent="üîê SP1 Zero-Knowledge Proof Terminal",t.style.fontWeight="bold",t.style.fontSize="20px",t.style.color="#fe22be",t.style.textShadow="0 0 10px rgba(254, 34, 190, 0.5)";const l=document.createElement("button");l.textContent="‚úñ",l.style.background="rgba(254, 34, 190, 0.2)",l.style.border="1px solid #fe22be",l.style.color="#ffffff",l.style.cursor="pointer",l.style.fontSize="18px",l.style.borderRadius="5px",l.style.padding="5px 10px",l.style.transition="all 0.2s",l.onmouseover=()=>l.style.backgroundColor="#fe22be",l.onmouseout=()=>l.style.backgroundColor="rgba(254, 34, 190, 0.2)",l.onclick=window.hideProofPanel,n.appendChild(t),n.appendChild(l);const r=document.createElement("div");r.id="proof-log",r.style.flexGrow="1",r.style.overflowY="auto",r.style.whiteSpace="pre-wrap",r.style.fontSize="14px",r.style.lineHeight="1.6",r.style.padding="15px",r.style.backgroundColor="rgba(0, 0, 0, 0.6)",r.style.borderRadius="10px",r.style.border="1px solid rgba(254, 34, 190, 0.3)",r.style.fontFamily="monospace";const s=document.createElement("div");s.id="proof-result",s.style.marginTop="15px",s.style.padding="15px",s.style.backgroundColor="rgba(0, 255, 0, 0.1)",s.style.borderRadius="10px",s.style.border="2px solid #00ff00",s.style.display="none";const a=document.createElement("button");return a.id="share-proof-btn",a.textContent="üîó GitHub",a.style.marginTop="15px",a.style.padding="12px 25px",a.style.backgroundColor="#fe22be",a.style.color="#ffffff",a.style.border="none",a.style.borderRadius="25px",a.style.fontSize="16px",a.style.fontWeight="bold",a.style.cursor="pointer",a.style.transition="all 0.2s",a.style.display="none",a.onmouseover=()=>a.style.backgroundColor="#d41a9e",a.onmouseout=()=>a.style.backgroundColor="#fe22be",a.onclick=()=>{window.open("https://github.com/d3lta02/zklabubu-sp1","_blank")},o.appendChild(n),o.appendChild(r),o.appendChild(s),o.appendChild(a),document.body.appendChild(o),console.log("Proof panel created!"),o},window.logToProofPanel=function(e){console.log("Log message:",e);const o=document.getElementById("proof-log");if(!o)return void console.error("proof-log element not found!");const n=new Date,t=`[${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}:${String(n.getSeconds()).padStart(2,"0")}] `,l=document.createElement("div");l.textContent=t+e,o.appendChild(l),o.scrollTop=o.scrollHeight},window.showProofPanel=function(){if(console.log("showProofPanel called"),null==a)return console.error("gameManager not defined!"),void alert("Game not started or GameManager not found!");try{window.createProofPanel();const e=a.get_score(),o=a.get_yellow_eggs_count(),n=a.get_blue_eggs_count(),t=a.get_purple_eggs_count(),l=a.get_game_time(),r=a.get_lives();console.log("Game Data:",{score:e,yellowEggs:o,blueEggs:n,purpleEggs:t,gameTime:l,lives:r}),window.logToProofPanel("Starting SP1 Zero-Knowledge Proof system..."),window.logToProofPanel(`Game Data: Score=${e}, Yellow=${o}, Blue=${n}, Purple=${t}, Time=${l}s, Lives=${r}`);const s={score:e,yellowEggs:o,blueEggs:n,purpleEggs:t,gameTime:l,lives:r};window.generateSP1Proof(s).then((e=>{console.log("Proof generation successful:",e)})).catch((e=>{console.error("Proof generation error:",e),window.logToProofPanel("Proof generation error: "+e.message)}))}catch(e){console.error("Error showing proof panel:",e),alert("An error occurred while showing proof panel: "+e.message)}},window.hideProofPanel=function(){const e=document.getElementById("proof-panel");e&&e.remove(),i=!1,console.log("Proof panel hidden")},document.getElementById("play-blue-btn").addEventListener("click",(()=>{te&&te.play().catch((e=>console.warn("Could not play button sound:",e))),ie("blue")})),document.getElementById("play-pink-btn").addEventListener("click",(()=>{te&&te.play().catch((e=>console.warn("Could not play button sound:",e))),ie("pink")})),B.addEventListener("click",(()=>ae(m))),L.addEventListener("click",(()=>ae(g))),A.addEventListener("click",me),$.addEventListener("click",(function(){if(a)try{const e=a.get_score(),o=a.get_yellow_eggs_count(),n=`I scored ${e} points in zkLabubu Game! Collected üü°${o} üîµ${a.get_blue_eggs_count()} üü£${a.get_purple_eggs_count()} eggs! Play at zklabubu.vercel.app @SuccinctLabs`,t=window.location.href;window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(n)}&url=${encodeURIComponent(t)}`,"_blank")}catch(e){console.error("Error sharing:",e),alert("An error occurred while sharing: "+e.message)}})),T.addEventListener("click",pe),k?k.addEventListener("click",ce):document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("global-sound-btn");e&&e.addEventListener("click",ce)})),I.addEventListener("click",(()=>{d&&te&&te.play().catch((e=>{})),re(!0)})),P.addEventListener("click",(()=>{d&&te&&te.play().catch((e=>{})),re(!1),r||(c=0,r=requestAnimationFrame(ge))})),C.addEventListener("click",(()=>{d&&te&&te.play().catch((e=>{})),re(!1),pe()})),S.addEventListener("click",(()=>{d&&te&&te.play().catch((e=>{})),re(!1),me()})),z.addEventListener("click",(function(){console.log("Prove button clicked"),"function"==typeof window.showProofPanel?window.showProofPanel():(console.error("showProofPanel function not found!"),alert("Proof panel function could not be loaded. Please refresh the page."))})),window.addEventListener("resize",(()=>{p.classList.contains("active")&&se()})),window.addEventListener("keydown",(e=>{if(p.classList.contains("active")&&a)try{if("Escape"===e.key)return void re(!x.classList.contains("hidden"));if(!x.classList.contains("hidden"))return;a.handle_key_press(e)}catch(e){console.error("Error handling keyboard event:",e)}})),document.addEventListener("DOMContentLoaded",(()=>{console.log("DOM loaded, initializing game..."),b&&(b.style.display="flex",b.classList.add("active")),setTimeout((()=>{!async function(){console.log("Loading game resources...");try{if(le(10),J.src="assets/images/bg_main.png",Q.src="assets/images/bg_game.png",V.src="assets/images/bg_gameover.png",M.src="assets/images/labubu_blue.png",G.src="assets/images/labubu_blue.png",q.src="assets/images/labubu_pink.png",F.src="assets/images/labubu_blue_shield.png",W.src="assets/images/labubu_blue_double.png",O.src="assets/images/labubu_pink_shield.png",R.src="assets/images/labubu_pink_double.png",j.src="assets/images/yellow_egg.png",D.src="assets/images/blue_egg.png",H.src="assets/images/purple_egg.png",N.src="assets/images/rock.png",U.src="assets/images/shield.png",Y.src="assets/images/double_points.png",K.src="assets/images/extra_life.png",Z.src="assets/images/slowdown.png",X.src="assets/sounds/bgmusic.mp3",ee.src="assets/sounds/star.mp3",oe.src="assets/sounds/rock.mp3",ne.src="assets/sounds/shield_hit.mp3",te.src="assets/sounds/button.mp3",X.loop=!0,X.volume=.5,ee.volume=.7,oe.volume=.8,ne.volume=.6,te.volume=.5,await new Promise((e=>{let o=0;const n=()=>{o++,le(20+o/17*30),o>=17&&e()};J.onload=n,Q.onload=n,V.onload=n,M.onload=n,G.onload=n,q.onload=n,F.onload=n,W.onload=n,O.onload=n,R.onload=n,j.onload=n,D.onload=n,H.onload=n,N.onload=n,U.onload=n,Y.onload=n,K.onload=n,Z.onload=n;const t=(e,o)=>{console.warn(`Failed to load ${e}, using fallback`),(e.includes("labubu_blue")||e.includes("labubu_pink"))&&(e.includes("labubu_blue")&&(G.src=M.src),e.includes("labubu_pink")&&(q.src=M.src)),n()};J.onerror=()=>t("bg_main.png"),Q.onerror=()=>t("bg_game.png"),V.onerror=()=>t("bg_gameover.png"),M.onerror=()=>t("labubu_blue.png"),G.onerror=()=>t("labubu_blue.png"),q.onerror=()=>t("labubu_pink.png"),F.onerror=()=>t("labubu_blue_shield.png"),W.onerror=()=>t("labubu_blue_double.png"),O.onerror=()=>t("labubu_pink_shield.png"),R.onerror=()=>t("labubu_pink_double.png"),j.onerror=()=>t("yellow_egg.png"),D.onerror=()=>t("blue_egg.png"),H.onerror=()=>t("purple_egg.png"),N.onerror=()=>t("rock.png"),U.onerror=()=>t("shield.png"),Y.onerror=()=>t("double_points.png"),K.onerror=()=>t("extra_life.png"),Z.onerror=()=>t("slowdown.png")})),le(50),console.log("All resources loaded successfully"),!await async function(){le(20);try{console.log("Loading WASM module...");const e=await l.e(936).then(l.bind(l,936));return await e.default(),window.wasm=e,console.log("WASM loaded and initialized successfully!"),s=!0,le(60),!0}catch(e){return console.error("Error loading WASM module:",e),le(40),!1}}()){console.error("WASM not available or failed to load!"),le(60);const e=document.querySelector("#initial-loading-screen h1");e&&(e.textContent="Error Loading Game!",e.style.color="#ff3333");const o=document.querySelector(".loading-container");if(o){const e=document.createElement("button");e.textContent="Reload Game",e.className="game-button",e.style.marginTop="20px",e.onclick=()=>window.location.reload(),o.appendChild(e)}return!1}return le(100),console.log("All resources and WASM loaded successfully"),setTimeout((()=>{ae(g)}),500),!0}catch(e){throw console.error("Error loading resources:",e),e}}()}),1e3)})),console.log("SP1 Proof panel functions defined")})();